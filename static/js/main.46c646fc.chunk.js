(this["webpackJsonpquality-lac-data-beta"]=this["webpackJsonpquality-lac-data-beta"]||[]).push([[0],{167:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),i=n(30),o=n.n(i),a=n(5),l=n(8),s=n(49),d=n(25),u=n(16),j=n(77),b=n(9),f=n.n(b),h=n(18),p=n(7),O=n(13);function v(e,t,n){return x.apply(this,arguments)}function x(){return(x=Object(h.a)(f.a.mark((function e(t,n,r){var c,i,o,a,l,s,d,u,j;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.pyodide,console.log("Passing uploaded data to Pyodide..."),a.globals.set("uploaded_files",t),a.globals.set("error_codes",n.filter((function(e){return e.selected})).map((function(e){return e.code}))),a.globals.set("metadata",r),l=[],e.prev=6,e.next=9,a.runPythonAsync('\n        from validator903.validator import Validator\n        from validator903.report import Report\n        from validator903.config import errors as configured_errors\n        from dataclasses import asdict\n        \n        validator = Validator(metadata.to_py(), uploaded_files.to_py())\n        result = validator.validate(error_codes.to_py())\n        print("Finished Validating")\n        \n        report = Report(result)\n        print("Created report")\n        \n        cr = report.child_report\n        print("Child report generated")\n        \n        js_files = {k: [t._asdict() for t in df.itertuples(index=True)] for k, df in validator.dfs.items()}\n        \n        error_definitions = {code: asdict(definition[0]) for code, definition in configured_errors.items()}\n\n        errors = {}\n        for row in report.child_report.itertuples():\n            errors.setdefault(row.Table, {}).setdefault(row.RowID, []).append(row.Code)\n                \n      ');case 9:e.next=17;break;case 11:e.prev=11,e.t0=e.catch(6),console.log("Caught Error!"),console.log(e.t0.toString()),s=e.t0.toString().split("\n"),l.push(s[s.length-2]);case 17:return d=null===(c=a.globals.get("js_files"))||void 0===c?void 0:c.toJs(),u=null===(i=a.globals.get("errors"))||void 0===i?void 0:i.toJs(),j=null===(o=a.globals.get("error_definitions"))||void 0===o?void 0:o.toJs(),console.log("Python calculation complete."),e.abrupt("return",[{data:d,errors:u,errorDefinitions:j},l]);case 22:case"end":return e.stop()}}),e,null,[[6,11]])})))).apply(this,arguments)}function g(){return m.apply(this,arguments)}function m(){return(m=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=window.pyodide)||void 0===t?void 0:t.runPython){e.next=12;break}return e.next=3,window.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/"});case 3:return window.pyodide=e.sent,e.next=6,window.pyodide.loadPackage(["micropip"]);case 6:return console.log("Loaded pyodide, now loading custom library..."),e.next=9,window.pyodide.runPythonAsync("\n      import logging\n      logging.basicConfig(level=logging.DEBUG)\n      \n      import micropip\n      await micropip.install('quality-lac-data-validator')\n    ");case 9:console.log("Loaded custom libary."),e.next=13;break;case 12:console.log("Pyodide already loaded.");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return w.apply(this,arguments)}function w(){return(w=Object(h.a)(f.a.mark((function e(){var t,n,r,c,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.pyodide,e.next=3,t.runPythonAsync("\n    from validator903.config import errors as configured_errors\n    all_error_definitions = [definition[0] for definition in configured_errors.values()]\n  ");case 3:n=window.pyodide.globals.get("all_error_definitions"),r=[],c=Object(u.a)(n);try{for(c.s();!(i=c.n()).done;)o=i.value,r.push({code:o.code,description:o.description,affectedFields:o.affected_fields,selected:!0})}catch(a){c.e(a)}finally{c.f()}return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=n(2);function k(e){var t,n=e.childIds,r=e.selected,c=e.setSelected,i=[],o=Object(u.a)(n.sort((function(e,t){return e[0].toString().localeCompare(t[0].toString())})).entries());try{var l=function(){var e=Object(p.a)(t.value,2),n=e[0],o=Object(p.a)(e[1],2),l=o[0],s=o[1],d=l,u=null;l===r&&(d=null,u={backgroundColor:"#ccc"}),i.push(Object(C.jsx)(a.s.Row,{children:Object(C.jsxs)(a.s.Cell,{onClick:function(){return c(d)},style:u,children:[Object(C.jsx)("div",{style:{float:"left",paddingLeft:"10px"},children:l}),Object(C.jsx)("div",{style:{float:"right",fontSize:"0.8em",paddingRight:"10px"},children:s>0?"".concat(s," errors"):"OK"})]},n)},n))};for(o.s();!(t=o.n()).done;)l()}catch(s){o.e(s)}finally{o.f()}return Object(C.jsx)("div",{style:{overflowY:"scroll",height:"100vh"},children:Object(C.jsx)(a.s,{style:{fontSize:"1em"},children:i})})}var S,E="Header",F="CHILD",D=n(24),_=n(1),A=_.b.div(S||(S=Object(D.a)(["\ntable {\n  font-size: 14px;\n}\n\ntd {\n  padding: 5px;\n}\n\n.error {\n  color: #D8000C;\n  background-color: #FFD2D2;\n}\n"])));function M(e){var t=e.rowData,n=e.highlight,r=[],c=[];if(t&&t.length>0){var i,o=Object(u.a)(Array.from(t[0].keys()).entries());try{for(o.s();!(i=o.n()).done;){var l=Object(p.a)(i.value,2),s=l[0],d=l[1];r.push(Object(C.jsx)(a.s.CellHeader,{children:d},s))}}catch(F){o.e(F)}finally{o.f()}var j,b=Object(u.a)(t.entries());try{for(b.s();!(j=b.n()).done;){var f,h=Object(p.a)(j.value,2),O=h[0],v=h[1],x=[],g=Object(u.a)(Array.from(v.entries()).entries());try{for(g.s();!(f=g.n()).done;){var m=Object(p.a)(f.value,2),y=m[0],w=Object(p.a)(m[1],2),k=w[0],S=w[1],E=n.has(JSON.stringify([v.get("Index"),k]));x.push(Object(C.jsx)(a.s.Cell,{className:E?"error":null,children:Number.isNaN(S)||void 0===S?"[null]":S.toString()},y))}}catch(F){g.e(F)}finally{g.f()}c.push(Object(C.jsx)(a.s.Row,{children:x},O))}}catch(F){b.e(F)}finally{b.f()}return Object(C.jsx)(A,{children:Object(C.jsxs)(a.s,{children:[Object(C.jsx)(a.s.Row,{children:r}),c]})})}return Object(C.jsx)(a.o,{children:"No data found for table."})}function L(e){var t=e.tableData,n=e.errorLocations,c=e.excludedTable,i=Object(r.useState)(0),o=Object(p.a)(i,2),l=o[0],s=o[1],d=Array.from(t.keys()).filter((function(e){return e!==c}));d.sort();var u=Array.from(d.entries()).map((function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return Object(C.jsx)(a.t.Tab,{onClick:function(){return s(n)},selected:l===n,children:r},n)})),j=Array.from(d.entries()).map((function(e){var r=Object(p.a)(e,2),c=r[0],i=r[1];return Object(C.jsx)(a.t.Panel,{selected:l===c,style:{overflowX:"auto"},children:Object(C.jsx)(M,{rowData:t.get(i),highlight:n.get(i)})},c)}));return Object(C.jsxs)(a.t,{children:[Object(C.jsx)(a.t.Title,{children:"Upload"}),Object(C.jsx)(a.t.List,{children:u}),j]})}var P,T=n(72),R=_.b.div(P||(P=Object(D.a)(["\n.floatingContainer {\n  display: block;\n  position: relative;\n  padding: 10px 10px;\n  top: 0;\n  left: 100px;\n  width: 300px;\n  height: 300px;\n  margin-top: 5px;\n  margin-bottom: -327px;\n  border: 1px solid black;\n  background-color: #fff;\n  font-size: 10px;\n}  \n\n.floatingClose {\n  cursor: pointer;\n  float: right;\n  position: relative;\n  top: -23px;\n  left: 10px;\n}\n\ninput {\n  height: 13px;\n  width: 180px;\n}\n\n.errorFilter {\n  height: 250px;\n  overflow-y: scroll;\n  padding-right: 10px;\n}\n\ntable {\n  font-size: 10px;\n}\n\n.selectedError {\n  background-color: #ccc;\n}\n"])));function N(e){var t=e.validatedData,n=e.setChildFilter,c=e.setErrorFilter,i=e.setShown,o=e.innerRef,l=Object(r.useState)(""),s=Object(p.a)(l,2),d=s[0],u=s[1],j=Object(r.useState)(null),b=Object(p.a)(j,2),f=b[0],h=b[1],O=Object(r.useMemo)((function(){var e=new Map;t.errors.forEach((function(t){t.forEach((function(t){t.forEach((function(t){e.set(t,e.get(t)?e.get(t)+1:1)}))}))}));var n=Array.from(e.entries());return n.sort((function(e,t){var n=Object(p.a)(e,2)[1];return Object(p.a)(t,2)[1]-n})),n.map((function(e){var n=Object(p.a)(e,2),r=n[0],c=n[1],i=t.errorDefinitions.get(r),o=r===f;return Object(C.jsxs)(a.s.Row,{className:o?"selectedError":null,onClick:function(){return h(o?null:r)},children:[Object(C.jsx)(a.s.Cell,{children:r}),Object(C.jsx)(a.s.Cell,{children:null===i||void 0===i?void 0:i.get("description")}),Object(C.jsx)(a.s.Cell,{children:c})]},r)}))}),[t,f]);Object(r.useEffect)((function(){n(d)}),[d,n]),Object(r.useEffect)((function(){c(f)}),[f,c]);var v=Object(r.useCallback)((function(){u(""),h(null)}),[u]);return Object(C.jsx)(R,{children:Object(C.jsxs)("div",{ref:o,className:"floatingContainer",children:[Object(C.jsx)(T.DebounceInput,{minLength:2,debounceTimeout:150,onChange:function(e){return u(e.target.value)},value:d,placeholder:"Enter a child ID to filter..."}),Object(C.jsx)("span",{onClick:function(){return i(!1)},className:"floatingClose",children:"[x]"}),Object(C.jsx)("button",{style:{float:"right"},onClick:v,children:"Clear filters"}),Object(C.jsx)("p",{children:"Click each row to filter for only that error type."}),Object(C.jsx)("div",{className:"errorFilter",children:Object(C.jsxs)(a.s,{children:[Object(C.jsxs)(a.s.Row,{children:[Object(C.jsx)(a.s.CellHeader,{children:"Code"}),Object(C.jsx)(a.s.CellHeader,{children:"Message"}),Object(C.jsx)(a.s.CellHeader,{children:"Count"})]}),O]})})]})})}function I(e){var t=e.validatedData,n=Object(r.useState)(null),c=Object(p.a)(n,2),i=c[0],o=c[1],l=Object(r.useState)(null),s=Object(p.a)(l,2),d=s[0],j=s[1],b=Object(r.useState)(null),O=Object(p.a)(b,2),v=O[0],x=O[1],g=Object(r.useState)(!1),m=Object(p.a)(g,2),y=m[0],w=m[1],S=Object(r.useRef)(null);Object(r.useEffect)((function(){return window.scrollTo(0,0)}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.current&&!S.current.contains(t.target)&&w(!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[S]);var D=Object(r.useMemo)((function(){var e=new Map;return t.data.forEach((function(n,r){e.set(r,function(e,t,n){var r,c=[];return null===(r=e.get(n))||void 0===r||r.forEach((function(e){e.get(F)===t&&c.push(e)})),c}(t.data,v,r))})),e}),[t,v]),_=Object(r.useMemo)((function(){var e=new Map;return t.errors.forEach((function(n,r){var c=new Set;n.forEach((function(e,n){e.forEach((function(e){var r;(null===(r=t.errorDefinitions.get(e))||void 0===r?void 0:r.get("affected_fields")).forEach((function(e){c.add(JSON.stringify([n,e]))}))}))})),e.set(r,c)})),e}),[t]),A=Object(r.useMemo)((function(){var e=function(e){var t=e.data,n=e.errors,r=new Map;return t.forEach((function(e,t){e.forEach((function(e){var c,i=e.get(F);r.has(i)||r.set(i,[]);var o=e.get("Index"),a=null===(c=n.get(t))||void 0===c?void 0:c.get(o);a&&a.forEach((function(e){var t;return null===(t=r.get(i))||void 0===t?void 0:t.push(e)}))}))})),r}(t);return Array.from(e.entries())}),[t]),P=Object(r.useMemo)((function(){var e,t=[],n=Object(u.a)(A);try{for(n.s();!(e=n.n()).done;){var r=Object(p.a)(e.value,2),c=r[0],o=r[1].filter((function(e){return!d||e===d})).length;(!i||c.toString().includes(i))&&(!d||o>0)&&t.push([c,o])}}catch(a){n.e(a)}finally{n.f()}return t}),[A,i,d]),T=Object(r.useMemo)((function(){var e=function(e,t){var n=e.data,r=e.errors;if(!t)return[];var c=[];return n.forEach((function(e,n){e.forEach((function(e){if(e.get(F)===t){var i,o=e.get("Index"),a=null===(i=r.get(n))||void 0===i?void 0:i.get(o);a&&a.forEach((function(e){return c.push(e)}))}}))})),c}(t,v),n=function(e){var n=t.errorDefinitions.get(e);return"Error ".concat(null===n||void 0===n?void 0:n.get("code")," - ").concat(null===n||void 0===n?void 0:n.get("description"))};return Array.from(e.entries()).map((function(e){var t=Object(p.a)(e,2),r=t[0],c=t[1];return Object(C.jsx)(a.m,{style:{fontSize:"1em"},children:n(c)},r)}))}),[t,v]);return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(a.h,{mb:5,children:[Object(C.jsxs)(a.g,{setWidth:"200px",children:[Object(C.jsxs)("div",{children:[Object(C.jsx)(a.j,{mb:8,style:{display:"inline",marginRight:"10px"},children:"Child ID"}),Object(C.jsx)("button",{onClick:function(e){e.stopPropagation(),w(!y)},style:{display:"inline",backgroundColor:i||d?"#a7c2d1":void 0},children:"Filter"})]}),y&&Object(C.jsx)(N,{innerRef:S,validatedData:t,setChildFilter:o,setErrorFilter:j,setShown:w}),Object(C.jsx)(k,{childIds:P,selected:v,setSelected:x})]}),Object(C.jsx)(a.g,{children:v?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)("div",{style:{width:"50%"},children:[Object(C.jsx)(a.j,{children:"Header"}),Object(C.jsx)(M,{rowData:D.get(E),highlight:_.get(E)})]}),Object(C.jsx)(a.q,{mb:9}),Object(C.jsx)(L,{tableData:D,errorLocations:_,excludedTable:E}),T.length>0?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(a.j,{children:"Errors"}),Object(C.jsx)(a.u,{style:{fontSize:"1em"},children:T})]}):Object(C.jsx)(C.Fragment,{})]}):Object(C.jsx)(a.b,{children:"Select a child..."})})]})})}var V,z,H=n(76),Y=_.b.div(V||(V=Object(D.a)(["\n  border: 2px dashed #999999;\n  padding: 5px;\n  color: #666666;\n\n  ul, li {\n    color: #666666;\n  }\n"])));function J(e){var t=e.onFiles,n=e.description,c=e.accept,i=e.displayedFiles,o=Object(r.useState)(),l=Object(p.a)(o,2),s=l[0],u=l[1],j=Object(r.useCallback)((function(e,r){t({description:n,acceptedFiles:e}),r.forEach((function(e){u(e.errors[0].message)}))}),[u,n,t]),b=Object(H.a)({onDrop:j,accept:c}),f=b.getRootProps,h=b.getInputProps,O=b.isDragActive;return Object(C.jsxs)(Y,Object(d.a)(Object(d.a)({},f()),{},{children:[Object(C.jsx)("input",Object(d.a)({},h())),i.length>0&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(a.o,{mb:1,children:"Located files (click to add more):"}),Object(C.jsx)(a.u,{mb:1,children:i.map((function(e){return Object(C.jsx)(a.m,{children:e.name},e.name)}))})]}),s?Object(C.jsx)("p",{style:{color:"red"},children:s}):O?Object(C.jsx)("p",{children:"Drop the files here ..."}):0===i.length?Object(C.jsx)("p",{children:"Drag and drop some files here, or click to select files"}):null]}))}var W=_.b.div(z||(z=Object(D.a)(["\n.disabled {\n  opacity: 50%;\n  pointer-events: none;\n}\n\n.disabledMode {\n  opacity: 50%;\n  pointer-events: none;\n  text-decoration: line-through;\n}\n"])));function X(e){var t=e.currentFiles,n=e.addFileContent,c=e.uploadErrors,i=(e.selectedErrors,e.setSelectedErrors,Object(r.useState)("csv")),o=Object(p.a)(i,2),l=o[0],s=o[1],d=Object(r.useCallback)((function(e){var t=e.description;e.acceptedFiles.forEach((function(e){var r=new FileReader;r.onabort=function(){return console.log("File reading failed.")},r.onerror=function(){return console.log("File reading error.")},r.onload=function(){var c=r.result;console.log("Finished reading (".concat(t,") file ").concat(e.name,".")),n({name:e.name,description:t,fileText:c})},r.readAsArrayBuffer(e)}))}),[n]);return Object(C.jsxs)(W,{children:[Object(C.jsx)(a.o,{children:"This tool will not send data to any third party. It uses the browser as an application to locate files in your computer and run scripts on them to identify errors. Once the browser is loaded, you can locate the files and run the validation offline."}),Object(C.jsxs)(a.t,{children:[Object(C.jsx)(a.t.Title,{children:"Locate"}),Object(C.jsxs)(a.t.List,{children:[Object(C.jsx)(a.t.Tab,{onClick:function(){return s("csv")},selected:"csv"===l,className:"csv"!==l&&t.length>0?"disabledMode":null,children:"CSV Files"}),Object(C.jsx)(a.t.Tab,{onClick:function(){return s("xml")},selected:"xml"===l,className:"xml"!==l&&t.length>0?"disabledMode":null,children:"XML Files"})]}),Object(C.jsx)(a.t.Panel,{selected:"csv"===l,children:Object(C.jsxs)(a.h,{children:[Object(C.jsxs)(a.g,{children:[Object(C.jsx)(a.k,{children:"This year"}),Object(C.jsx)(J,{description:"This year (CSV)",onFiles:d,accept:".csv",displayedFiles:t.filter((function(e){return"This year (CSV)"===e.description}))})]}),Object(C.jsxs)(a.g,{setWidth:"one-half",className:t.length>0?null:"disabled",children:[Object(C.jsx)(a.k,{children:"Previous year"}),Object(C.jsx)(J,{description:"Prev year (CSV)",onFiles:d,accept:".csv",displayedFiles:t.filter((function(e){return"Prev year (CSV)"===e.description}))})]})]})}),Object(C.jsx)(a.t.Panel,{selected:"xml"===l,children:Object(C.jsxs)(a.h,{children:[Object(C.jsxs)(a.g,{children:[Object(C.jsx)(a.k,{children:"This year"}),Object(C.jsx)(J,{description:"This year (XML)",onFiles:d,accept:".xml",displayedFiles:t.filter((function(e){return"This year (XML)"===e.description}))})]}),Object(C.jsxs)(a.g,{setWidth:"one-half",className:t.length>0?null:"disabled",children:[Object(C.jsx)(a.k,{children:"Previous year"}),Object(C.jsx)(J,{description:"Prev year (XML)",onFiles:d,accept:".xml",displayedFiles:t.filter((function(e){return"Prev year (XML)"===e.description}))})]})]})})]}),c.length>0?Object(C.jsx)(a.d,{summary:"Errors",open:!0,children:Array.from(c.entries(),(function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return Object(C.jsx)(a.e,{children:r.toString()},n)}))}):null]})}var U=n(50),q=n(51),B=n.n(q),G=function(){var e=Object(h.a)(f.a.mark((function e(t){var n,r,c,i,o,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=B()().format("YYYYMMDD-HHmmss"),r="ChildErrorSummary"===t?"children":"errors",c=window.pyodide;try{i=c.globals.get("report"),o=i.csv_report(r),a=new Blob([o],{type:"text/csv"}),i.destroy(),Object(U.saveAs)(a,"".concat(t,"-").concat(n,".csv"))}catch(l){console.log("Caught Error!"),console.log(l.toString())}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=n(74).map((function(e){return{la_id:e.UTLA21CD,la_name:e.UTLA21NM}})).reduce((function(e,t){return e[t.la_id]=t,e}),{}),Z=Object.values(K).sort((function(e,t){return e.la_name>t.la_name?1:-1}));function Q(){var e=Object(r.useState)("Loading Python initially (takes around 30 seconds)..."),t=Object(p.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)([]),o=Object(p.a)(i,2),l=o[0],s=o[1],b=Object(r.useState)([]),O=Object(p.a)(b,2),x=O[0],m=O[1],w=Object(r.useState)(),k=Object(p.a)(w,2),S=k[0],E=k[1],F=Object(r.useState)([]),D=Object(p.a)(F,2),_=D[0],A=D[1],M=Object(r.useState)(Z[0].la_id),L=Object(p.a)(M,2),P=L[0],T=L[1],R=Object(r.useMemo)((function(){return function(e){var t=new Date,n=t.getFullYear();t.getMonth()<4&&(n-=1);for(var r=[n],c=1;c<e;c++)r.push(n-c);return r.map((function(e){return"".concat(e,"/").concat((e+1)%100)}))}(5)}),[]),N=Object(r.useState)(R[0]),V=Object(p.a)(N,2),z=V[0],H=V[1];Object(r.useEffect)((function(){Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return e.next=4,y();case 4:t=e.sent,A(t),c("");case 7:case"end":return e.stop()}}),e)})))()}),[]);var Y=Object(r.useCallback)((function(e){l.push(e),s(Object(j.a)(l))}),[l]),J=Object(r.useCallback)((function(){m([]),E(null),s([])}),[]),W=Object(r.useCallback)(Object(h.a)(f.a.mark((function e(){var t,n,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m([]),c("Loading postcode file (initial load takes 60 seconds)..."),t={localAuthority:P,collectionYear:z},c("Running validation..."),e.next=6,v(l,_,t);case 6:n=e.sent,r=Object(p.a)(n,2),i=r[0],0===(o=r[1]).length?E(i):(J(),m(o)),c("");case 12:case"end":return e.stop()}}),e)}))),[l,_,J,P,z]),U=Object(r.useCallback)((function(){S&&Promise.all([G("ErrorCounts"),G("ChildErrorSummary")]).then((function(){console.log("Export completed")})).catch((function(){console.error("Export failed")}))}),[S]),q=Object(r.useCallback)((function(e){var t,n=[],r=Object(u.a)(_);try{for(r.s();!(t=r.n()).done;){var c=t.value,i=Object(d.a)({},c);i.code===e.code&&(i.selected=!i.selected),n.push(i)}}catch(o){r.e(o)}finally{r.f()}A(n)}),[_,A]),B=Object(r.useCallback)((function(e){var t,n=[],r=Object(u.a)(_);try{for(r.s();!(t=r.n()).done;){var c=t.value,i=Object(d.a)({},c);i.selected=e,n.push(i)}}catch(o){r.e(o)}finally{r.f()}A(n)}),[_,A]);Object(r.useEffect)((function(){var e=window.localStorage.getItem("localAuthority");e&&Z.some((function(t){return t.la_id===e}))&&T(e)}),[T]);var K=Object(r.useCallback)((function(e){T(e.target.value),window.localStorage.setItem("localAuthority",e.target.value)}),[T]);return Object(C.jsxs)(C.Fragment,{children:[S?Object(C.jsx)(I,{validatedData:S}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(X,{currentFiles:l,addFileContent:Y,uploadErrors:x,selectedErrors:_,setSelectedErrors:A}),Object(C.jsx)(a.r,{input:{value:z,onChange:function(e){return H(e.target.value)}},label:"Collection Year",mb:4,children:R.map((function(e){return Object(C.jsx)("option",{value:e,children:e},e)}))}),Object(C.jsx)(a.r,{input:{value:P||void 0,onChange:K},label:"Local Authority",mb:4,children:Z.map((function(e){var t=e.la_id,n=e.la_name;return Object(C.jsx)("option",{value:t,children:n},t)}))})]}),Object(C.jsxs)($,{loading:n,children:[Object(C.jsxs)(a.d,{summary:"Validation Rules (".concat(_.filter((function(e){return e.selected})).length," selected, ").concat(_.filter((function(e){return!e.selected})).length," unselected)"),children:[Object(C.jsx)(a.a,{onClick:function(){return B(!0)},children:"Select All "})," ",Object(C.jsx)(a.a,{onClick:function(){return B(!1)},children:"Deselect All "}),_.map((function(e){return Object(C.jsxs)(a.c,{checked:e.selected,onChange:function(){return q(e)},children:[e.code," - ",e.description]},e.code)}))]}),Object(C.jsx)("div",{style:{marginRight:"10%",display:"inline"},children:Object(C.jsx)(a.a,{onClick:W,children:"Validate"})}),Object(C.jsx)("div",{style:{marginRight:"10%",display:"inline"},children:Object(C.jsx)(a.a,{onClick:J,children:"Clear Data and Start Again"})}),Object(C.jsx)("div",{style:{marginRight:"10%",display:"inline"},children:S?Object(C.jsx)(a.a,{onClick:U,children:"Download CSVs"}):Object(C.jsx)(a.a,{buttonColour:"gray",disabled:!0,children:"Download CSVs"})})]})]})}function $(e){var t=e.children,n=e.loading;return n?Object(C.jsxs)("div",{style:{position:"relative",pointerEvents:"none"},children:[Object(C.jsxs)("div",{style:{width:"100%",position:"absolute",display:"flex",justifyContent:"center",flexWrap:"wrap"},children:[Object(C.jsx)("div",{style:{width:"100%",textAlign:"center",height:"25px",fontSize:"24px"},children:n}),Object(C.jsx)(O.e,{style:{width:"50px",height:"50px",display:"block"}})]}),Object(C.jsx)("div",{style:{opacity:"30%"},children:t})]}):t}function ee(){return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(a.o,{children:"Click Start to begin."}),Object(C.jsx)(a.a,{start:!0,as:s.a,to:"/application",children:"Start now"})]})}var te=function(){return Object(C.jsxs)(l.a,{children:[Object(C.jsx)(a.f,{}),Object(C.jsxs)(a.n.WidthContainer,{style:{height:"100vh",width:"75%",maxWidth:"none"},children:[Object(C.jsxs)(a.p,{level:"beta",children:["This is a new service - ",Object(C.jsx)(a.l,{href:"https://join.slack.com/t/datatoinsight/shared_invite/zt-nuw179pj-n5Glvc7S1bFbeE~l2vZf_w",children:"your feedback can help us improve it."})]}),Object(C.jsxs)(a.n.Main,{children:[Object(C.jsx)(a.i,{children:"SSDA903 Data Validation Service"}),Object(C.jsxs)(l.d,{children:[Object(C.jsx)(l.b,{path:"/application",component:Q}),Object(C.jsx)(l.b,{exact:!0,path:"/",component:ee})]})]})]})]})};n(166);o.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(te,{})}),document.getElementById("root"))}},[[167,1,2]]]);
//# sourceMappingURL=main.46c646fc.chunk.js.map